!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=(window.__sw__.assetPath + '/bundles/froshexporter/'),n(n.s="2KkW")}({"2KkW":function(t,e,n){"use strict";n.r(e);Shopware.Component.extend("frosh-export-create","frosh-export-detail",{template:"{% block frosh_export_detail_content_trigger_button %}\n{% endblock %}\n",methods:{getEntity:function(){this.entity=this.froshExportRepository.create(Shopware.Context.api)},onClickSave:function(){var t=this;this.isLoading=!0,this.froshExportRepository.save(this.entity,Shopware.Context.api).then((function(){t.isLoading=!1,t.$router.push({name:"frosh.export.detail",params:{id:t.entity.id}})})).catch((function(e){t.isLoading=!1,t.createNotificationError({title:t.$tc("frosh-export.detail.errorTitle"),message:e})}))}}});var r=Shopware,o=r.Component,i=r.Mixin,a=Shopware.Data.Criteria;o.register("frosh-export-list",{template:'{% block frosh_export_list %}\n    <sw-page class="frosh-export-list">\n\n        {% block sw_product_list_search_bar %}\n            <template #search-bar>\n                <sw-search-bar initialSearchType="frosh_export"\n                               :initialSearch="term"\n                               @search="onSearch">\n                </sw-search-bar>\n            </template>\n        {% endblock %}\n\n        {% block sw_product_list_smart_bar_header %}\n            <template #smart-bar-header>\n                {% block sw_product_list_smart_bar_header_title %}\n                    <h2>\n                        {% block sw_product_list_smart_bar_header_title_text %}\n                            {{ $tc(\'frosh-export.general.mainMenuItemGeneral\') }}\n                        {% endblock %}\n\n                        {% block sw_product_list_smart_bar_header_amount %}\n                            <span v-if="!isLoading" class="sw-page__smart-bar-amount">\n                                ({{ total }})\n                            </span>\n                        {% endblock %}\n                    </h2>\n                {% endblock %}\n            </template>\n        {% endblock %}\n\n        {% block frosh_export_list_smart_bar_actions %}\n            <template #smart-bar-actions>\n                {% block frosh_export_list_smart_bar_actions_add %}\n                    <sw-button :routerLink="{ name: \'frosh.export.create\' }" variant="primary">\n                        {{ $tc(\'frosh-export.list.create\') }}\n                    </sw-button>\n                {% endblock %}\n            </template>\n        {% endblock %}\n\n        <template #content>\n            {% block frosh_export_list_content %}\n                <div class="frosh-export-list__content">\n\n                    <sw-entity-listing\n                        v-if="entities"\n                        :items="entities"\n                        :repository="froshExportRepository"\n                        :showSelection="false"\n                        :columns="columns"\n                        detailRoute="frosh.export.detail"\n                    >\n                        {% block frosh_export_list_content_listing_list_data_grid_column_created %}\n                            <template #column-latestExecute="{ item }">\n                                {{ item.latestExecute | date({ hour: \'2-digit\', minute: \'2-digit\' }) }}\n                            </template>\n                        {% endblock %}\n                    </sw-entity-listing>\n                </div>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n',inject:["repositoryFactory"],mixins:[i.getByName("notification"),i.getByName("listing"),i.getByName("placeholder")],data:function(){return{sortBy:"name",defaultSortBy:"name",sortDirection:"DESC",naturalSorting:!0,entities:null,total:0,isLoading:!1}},metaInfo:function(){return{title:this.$createTitle()}},computed:{froshExportRepository:function(){return this.repositoryFactory.create("frosh_export")},columns:function(){return[{property:"name",dataIndex:"name",label:this.$tc("frosh-export.detail.name"),routerLink:"frosh.export.detail",inlineEdit:"string",allowResize:!0,primary:!0},{property:"entity",dataIndex:"entity",label:this.$tc("frosh-export.detail.firstName"),routerLink:"frosh.export.detail",inlineEdit:"string",allowResize:!0,primary:!0},{property:"latestExecute",dataIndex:"latestExecute",label:this.$tc("frosh-export.detail.latestExecute"),allowResize:!0,primary:!0}]},defaultCriteria:function(){var t=new a(this.page,this.limit);return t.setTerm(this.term),t}},methods:{updateTotal:function(t){var e=t.total;this.total=e},getList:function(){var t=this;return this.isLoading=!0,this.froshExportRepository.search(this.defaultCriteria,Shopware.Context.api).then((function(e){return t.total=e.total,t.entities=e,t.isLoading=!1,e})).catch((function(){t.isLoading=!1}))}}});var s=Shopware,l=s.Component,c=s.Mixin,p=Shopware.Data.Criteria;function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,i=void 0,i=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===u(i)?i:String(i)),r)}var o,i}function h(t,e){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b(this,n)}}function b(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}l.register("frosh-export-detail",{template:'{% block frosh_export_detail %}\n    <sw-page class="frosh-export-detail">\n\n        {% block frosh_export_detail_actions %}\n            <template slot="smart-bar-actions">\n                {% block frosh_export_detail_actions_abort %}\n                    <sw-button\n                            :disabled="isLoading"\n                            @click="onCancel">\n                        {{ $tc(\'frosh-export.detail.cancel\') }}\n                    </sw-button>\n                {% endblock %}\n\n                {% block frosh_export_detail_actions_save %}\n                    <sw-button-process\n                            class="sw-product-detail__save-action"\n                            :isLoading="isLoading"\n                            :processSuccess="processSuccess"\n                            :disabled="isLoading"\n                            variant="primary"\n                            @process-finish="saveFinish"\n                            @click="onClickSave"\n                    >\n                        {{ $tc(\'frosh-export.detail.save\') }}\n                    </sw-button-process>\n                {% endblock %}\n\n            </template>\n        {% endblock %}\n\n        <template slot="content">\n            <sw-card-view>\n                {% block frosh_export_detail_content %}\n\n                    <sw-card :title="$tc(\'frosh-export.detail.baseLabel\')"\n                             v-if="entity">\n                        <sw-datepicker\n                                v-model="entity.latestExecute"\n                                :label="$tc(\'frosh-export.detail.latestExecute\')"\n                                :disabled="true"\n                                date-type="datetime-local"\n                        />\n                        <sw-text-field\n                                v-model="entity.name"\n                                :label="$tc(\'frosh-export.detail.name\')"\n                                value="entity.name"\n                                :required="true">\n                        </sw-text-field>\n                        <sw-text-field\n                                v-model="entity.entity"\n                                :label="$tc(\'frosh-export.detail.entity\')"\n                                value="entity.entity"\n                                :required="true">\n                        </sw-text-field>\n\n                        <sw-multi-tag-select\n                                v-model="entity.fields"\n                                :label="$tc(\'frosh-export.detail.entity\')"\n                                :placeholder="$tc(\'frosh-export.detail.fields\')"\n                        >\n                            <template #message-add-data>\n                                <span>{{ $tc(\'frosh-export.detail.addField\') }}</span>\n                            </template>\n                            <template #message-enter-valid-data>\n                                <span>{{ $tc(\'frosh-export.detail.enterField\') }}</span>\n                            </template>\n                        </sw-multi-tag-select>\n\n                        <sw-entity-single-select\n                                v-model="entity.productStreamId"\n                                entity="product_stream"\n                                :label="$tc(\'frosh-export.detail.productStream\')"\n                                value="entity.productStreamId"\n                                :disabled="entity.entity != \'product\'">\n                        </sw-entity-single-select>\n\n                        {% block frosh_export_detail_content_trigger_button %}\n                            <sw-button @click="triggerExport">\n                                {{ $tc(\'frosh-export.detail.triggerButton\') }}\n                            </sw-button>\n                        {% endblock %}\n\n                        {% block frosh_export_detail_content_download_button %}\n                            <sw-button\n                                    class="action"\n                                    :disabled="entity.isPrivate || isDownloading"\n                                    @click="downloadExport"\n                            >\n                                {{ $tc(\'frosh-export.detail.downloadButton\') }}\n                            </sw-button>\n                        {% endblock %}\n                    </sw-card>\n                {% endblock %}\n            </sw-card-view>\n        </template>\n    </sw-page>\n{% endblock %}\n',inject:["repositoryFactory","froshExportService"],mixins:[c.getByName("notification")],metaInfo:function(){return{title:this.$createTitle()}},data:function(){return{entity:null,isLoading:!1,processSuccess:!1,isDownloading:!1}},computed:{froshExportRepository:function(){return this.repositoryFactory.create("frosh_export")}},created:function(){this.getEntity()},methods:{getEntity:function(){var t=this,e=new p;this.froshExportRepository.get(this.$route.params.id,Shopware.Context.api,e).then((function(e){t.entity=e}))},onCancel:function(){this.$router.push({name:"frosh.export.index"})},onClickSave:function(){var t=this;this.isLoading=!0,this.froshExportRepository.save(this.entity,Shopware.Context.api).then((function(){t.getEntity(),t.isLoading=!1,t.processSuccess=!0})).catch((function(e){t.isLoading=!1,t.createNotificationError({title:t.$tc("frosh-export.detail.errorTitle"),message:e})}))},saveFinish:function(){this.processSuccess=!1},triggerExport:function(){this.froshExportService.triggerExport(this.entity.id)},downloadExport:function(){this.isDownloading=!0;var t=document.createElement("a");t.href="/"+this.entity.filePath,t.download=this.entity.name,t.dispatchEvent(new MouseEvent("click")),t.remove(),this.isDownloading=!1}}}),Shopware.Module.register("frosh-export",{type:"plugin",name:"frosh-export.general.mainName",title:"frosh-export.general.mainMenuItemGeneral",description:"frosh-export.general.descriptionTextModule",color:"#ff3d58",icon:"default-shopping-paper-bag-product",entity:"frosh_export",routes:{index:{component:"frosh-export-list",path:"list",meta:{privilege:"frosh_export.viewer"}},detail:{component:"frosh-export-detail",path:"detail/:id",meta:{parentPath:"frosh.export.index",privilege:"frosh_export.viewer"},props:{default:function(t){return{froshExport:t.params.id}}}},create:{component:"frosh-export-create",path:"create",meta:{parentPath:"frosh.export.index",privilege:"frosh_export.viewer"}}},navigation:[{path:"frosh.export.index",privilege:"frosh_export.viewer",label:"frosh-export.general.mainMenuItemGeneral",id:"frosh-export",parent:"sw-catalogue",position:90}]});var x=Shopware.Classes.ApiService,_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(i,t);var e,n,r,o=m(i);function i(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sw";return d(this,i),(n=o.call(this,t,e,r)).name="froshExportService",n}return e=i,(n=[{key:"triggerExport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e,o=this.getBasicHeaders(n);return this.httpClient.get("/frosh/export/".concat(t,"/trigger"),{params:r,headers:o}).then((function(t){return x.handleResponse(t)}))}}])&&f(e.prototype,n),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(x);Shopware.Application.addServiceProvider("froshExportService",(function(){var t=Shopware.Application.getContainer("init");return new _(t.httpClient,Shopware.Service("loginService"))}))}});